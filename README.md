# User Authentication Server

A Node.js and Express.js server for user authentication supporting local
(email/password) and OAuth methods. This project is designed for extensibility,
allowing new providers and features to be added easily.

**note:** this docs is generated by AI and Supervise by the author.

## Features

- Local Authentication (Email & Password)
- Google OAuth 2.0 (Login/Register with Google)
- User info retrieval and update
- Access token refresh and logout
- API endpoints for server status/info
- Modular and extensible route structure

## Installation

To run the app locally:

1. **Clone the repository:**

   ```bash
   git clone https://github.com/codernelly34/user_authentication.git
   cd user_authentication
   ```

2. **Install dependencies:**

   ```bash
   npm install
   ```

3. **Setup environment variables:**

   - Copy the sample env file and fill in your credentials:
     ```bash
     cp .env.sample .env
     # Edit .env with your DB URI, OAuth keys, etc.
     ```

4. **Start the server:**
   ```bash
   npm run start     # Production
   npm run dev       # Development mode (with nodemon)
   ```

## Usage

Once running locally, you can interact with the API using tools like Postman,
curl, or via your frontend app.

### Server Info and Health

| Method | Endpoint  | Description                                  |
| ------ | --------- | -------------------------------------------- |
| GET    | `/`       | Basic server info                            |
| GET    | `/info`   | Info about the app/server                    |
| GET    | `/status` | Server health/status (uptime, version, etc.) |

---

### Local Authentication

#### Register

- **POST** `/account/local/register`
  - Register a new user.
  - **Request body:**
    ```json
    {
      "firstName": "John",
      "lastName": "Doe",
      "email": "john.doe@example.com",
      "password": "SecurePassword123"
    }
    ```
  - **Response:** Created user object (on success) or error object (on failure).

#### Login

- **POST** `/account/local/login`
  - Log in with email and password.
  - **Request body:**
    ```json
    {
      "email": "john.doe@example.com",
      "password": "SecurePassword123"
    }
    ```
  - **Response:** User object (on success, with auth cookies set) or error
    object.

#### Logout

- **GET** `/account/logout`
  - Logs out the authenticated user by clearing access and refresh tokens
    (cookies).
  - **Response:** Success message or error object.

#### Refresh Access Token

- **GET** `/account/refresh-access`
  - Refresh the user's access token with a valid refresh token (cookie).
  - **Response:** New access/refresh tokens set in cookies, or error object.

---

### Google OAuth

#### Start Google OAuth

- **GET** `/account/google/register`
  - Redirects to Google OAuth consent screen.

#### Google OAuth Callback

- **GET** `/account/google/redirect`
  - Handles the OAuth callback, issues tokens, and logs in/registers the user.
  - **Response:** On first login, creates a new user; otherwise, logs in the
    user. Returns welcome message and user info.

---

### User Profile (Protected)

_All these endpoints require authentication (valid `accessToken` cookie)._

#### Get User Info

- **GET** `/privet/get-user-info`
  - Retrieves the authenticated user's info.
  - **Response:** User object or error.

#### Update User Info

- **PUT** `/privet/update-user-info`
  - Update fields in the authenticated user's profile.
  - **Request body:** Supply only fields you want to update, e.g.:
    ```json
    {
      "firstName": "Jane",
      "lastName": "Smith"
    }
    ```
  - **Response:** Updated user object or error.

---

## Error Handling

- All unknown routes return a 404 with a message indicating the route was not
  found.
- Consistent error responses with HTTP status codes and error messages.

## Roadmap

- Add Facebook, GitHub, and other OAuth providers
- Email verification and password reset flows
- Rate limiting and enhanced security
- Production deployment scripts

## Contributing

Pull requests are welcome! Please open issues for suggestions or bug reports.

## License

MIT

---

**Note:** This server is currently not deployedâ€”run locally to test. Ensure your
`.env` configuration is correct for local development.
